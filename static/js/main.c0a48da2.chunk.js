(this["webpackJsonpformula-editor"]=this["webpackJsonpformula-editor"]||[]).push([[0],{103:function(t,e,n){"use strict";n.r(e);var i=n(0),r=n.n(i),a=n(10),c=n.n(a),s=(n(96),n(14)),o=n(146),l=n(140),u=n(11),h=n(26),d=function t(e,n,i){Object(u.a)(this,t),this.type=void 0,this.text=void 0,this.pos=void 0,this.type=e,this.text=n,this.pos=i},j=function t(e,n){Object(u.a)(this,t),this.name=void 0,this.regexp=void 0,this.name=e,this.regexp=n},f={NUMBER:new j("NUMBER","[0-9]*"),VARIABLE:new j("VARIABLE","([a-z][0-9]?)*"),OPERAND:new j("OPERAND","\\[\\w*\\]"),FUNCTION:new j("FUNCTION","[A-Z]*\\(.*\\)"),SEMICOLON:new j("SEMICOLON",";"),SPACE:new j("SPACE","[ \\n\\t\\r]"),ASSIGN:new j("ASSIGN","\\="),RETURN:new j("RETURN","RETURN"),PLUS:new j("PLUS","\\+"),MINUS:new j("MINUS","\\-"),DIVIDE:new j("DIVIDE","\\/"),MULTIPLY:new j("MULTIPLY","\\*"),LPAR:new j("LPAR","\\("),RPAR:new j("RPAR","\\)")},O=function(){function t(e){Object(u.a)(this,t),this.code=void 0,this.pos=0,this.tokenList=[],this.code=e}return Object(h.a)(t,[{key:"lexAnalisys",value:function(){for(;this.nextToken(););return this.tokenList=this.tokenList.filter((function(t){return t.type.name!==f.SPACE.name})),this.tokenList}},{key:"nextToken",value:function(){if(this.pos>=this.code.length)return!1;for(var t=Object.values(f),e=0;e<t.length;e++){var n=t[e],i=new RegExp("^"+n.regexp),r=this.code.substr(this.pos).match(i);if(r&&r[0]){var a=new d(n,r[0],this.pos);return this.pos+=r[0].length,this.tokenList.push(a),!0}}throw new Error("\u041d\u0432 \u043f\u043e\u0437\u0438\u0446\u0438\u0438 ".concat(this.pos," \u043e\u0431\u043d\u0430\u0440\u0443\u0436\u0435\u043d\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"))}}]),t}(),b=n(24),v=n(22),p=function t(){Object(u.a)(this,t)},x=function(t){Object(b.a)(n,t);var e=Object(v.a)(n);function n(){var t;Object(u.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))).codeStrings=[],t}return Object(h.a)(n,[{key:"addNode",value:function(t){this.codeStrings.push(t)}}]),n}(p),g=function t(e){Object(u.a)(this,t),this.number=void 0,this.number=e},N=function(t){Object(b.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(u.a)(this,n),(i=e.call(this)).variable=void 0,i.variable=t,i}return n}(p),R=function(t){Object(b.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(u.a)(this,n),(i=e.call(this)).operand=void 0,i.operand=t,i}return n}(p),y=function(t){Object(b.a)(n,t);var e=Object(v.a)(n);function n(t,i,r){var a;return Object(u.a)(this,n),(a=e.call(this)).operator=void 0,a.leftNode=void 0,a.rightNode=void 0,a.operator=t,a.leftNode=i,a.rightNode=r,a}return n}(p),m=function t(e,n){Object(u.a)(this,t),this.operator=void 0,this.operand=void 0,this.operator=e,this.operand=n},E=function(t){Object(b.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(u.a)(this,n),(i=e.call(this)).function_=void 0,i.function_=t,i}return n}(p),A=function(){function t(e){Object(u.a)(this,t),this.tokens=void 0,this.pos=0,this.scope={},this.tokens=e}return Object(h.a)(t,[{key:"match",value:function(){if(this.pos<this.tokens.length){for(var t=this.tokens[this.pos],e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];if(n.find((function(e){return e.name===t.type.name})))return this.pos+=1,t}return null}},{key:"require",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=this.match.apply(this,e);if(!i)throw new Error("\u043d\u0430 \u043f\u043e\u0437\u0438\u0446\u0438\u0438 ".concat(this.pos," \u043e\u0436\u0438\u0434\u0430\u0435\u0442\u0441\u044f ").concat(e[0].name));return i}},{key:"parseVariableOrNumberOrOperand",value:function(){var t=this.match(f.NUMBER);if(null!=t)return new g(t);var e=this.match(f.VARIABLE);if(null!=e)return new N(e);var n=this.match(f.OPERAND);if(null!=n)return new R(n);var i=this.match(f.FUNCTION);if(null!=i)return new E(i);throw new Error("\u041e\u0436\u0438\u0434\u0430\u0435\u0442\u0441\u044f (\u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0430\u044f/\u0447\u0438\u0441\u043b\u043e/\u043e\u043f\u0435\u0440\u0430\u043d\u0434) \u043d\u0430 ".concat(this.pos," \u043f\u043e\u0437\u0438\u0446\u0438\u0438"))}},{key:"parseReturn",value:function(){var t=this.match(f.RETURN);if(null!=t)return new m(t,this.parseFormula());throw new Error("\u041e\u0436\u0438\u0434\u0430\u0435\u0442\u0441\u044f \u0443\u043d\u0430\u0440\u043d\u044b\u0439 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 RETURN \u043d\u0430 ".concat(this.pos," \u043f\u043e\u0437\u0438\u0446\u0438\u0438"))}},{key:"parseParentheses",value:function(){if(null!=this.match(f.LPAR)){var t=this.parseFormula();return this.require(f.RPAR),t}return this.parseVariableOrNumberOrOperand()}},{key:"parseFormula",value:function(){for(var t=this.parseParentheses(),e=this.match(f.MINUS,f.PLUS,f.DIVIDE,f.MULTIPLY);null!=e;){var n=this.parseParentheses();t=new y(e,t,n),e=this.match(f.MINUS,f.PLUS,f.DIVIDE,f.MULTIPLY)}return t}},{key:"parseExpression",value:function(){if(null==this.match(f.VARIABLE))return this.parseReturn();this.pos-=1;var t=this.parseVariableOrNumberOrOperand(),e=this.match(f.ASSIGN);if(null!=e){var n=this.parseFormula();return new y(e,t,n)}throw new Error("\u041f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439 \u043e\u0436\u0438\u0434\u0430\u0435\u0442\u0441\u044f \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 \u043f\u0440\u0438\u0441\u0432\u043e\u0435\u043d\u0438\u044f \u043d\u0430 \u043f\u043e\u0437\u0438\u0446\u0438\u0438 ".concat(this.pos))}},{key:"parseCode",value:function(){for(var t=new x;this.pos<this.tokens.length;){var e=this.parseExpression();this.require(f.SEMICOLON),t.addNode(e)}return t}}]),t}(),S=n(145),C=n(133),w=n(151),T=n(135),I=n(137),k=n(138),U=n(139),L=n(78),F=n.n(L),P=n(42),M=function(){return Object(P.b)()},D=P.c,_=n(53),V=Object(_.b)({name:"code",initialState:{value:"",index:0,brace:!1},reducers:{setCode:function(t,e){t.value=e.payload},setCurrentIndex:function(t,e){t.index=e.payload},toggleBrace:function(t){t.brace=!t.brace}}}),B=V.actions,z=B.setCode,G=B.setCurrentIndex,H=B.toggleBrace,X=function(t){return t.code.value},Q=function(t){return t.code.index},Y=function(t){return t.code.brace},q=V.reducer,J=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(u.a)(this,t),this.type=void 0,this.index=void 0,this.value=void 0,this.left=void 0,this.right=void 0,this.index=e,this.type="OPERAND",this.value=null,this.left=null,this.right=null}return Object(h.a)(t,[{key:"setValue",value:function(t){this.value=t}},{key:"setLeft",value:function(){t.count++,this.left=new t(t.count)}},{key:"setRight",value:function(){t.count++,this.right=new t(t.count)}}]),t}();J.count=0;var W=new(function(){function t(){Object(u.a)(this,t),this.root=new J}return Object(h.a)(t,[{key:"find",value:function(t){return this.root.index===t?this.root:this._find(this.root.left,t)||this._find(this.root.right,t)}},{key:"_find",value:function(t,e){return t?t.index===e?t:this._find(t.left,e)||this._find(t.right,e):null}}]),t}()),Z=n(2),K=Object(C.a)((function(t){return Object(w.a)({root:{width:"100%",backgroundColor:t.palette.background.paper}})}));function $(t){var e=M(),n=(D(X),D(Q)),i=K(),a=r.a.useState(1),c=Object(s.a)(a,2),o=c[0],l=c[1];return Object(Z.jsx)("div",{className:i.root,children:Object(Z.jsx)(T.a,{component:"nav",children:t.items.map((function(i,r){return Object(Z.jsxs)(I.a,{button:!0,selected:o===r,onClick:function(a){return function(i,r,a){console.log(t.type),l(r),e(z(a));var c=W.find(n);c&&(c.value=a,c.type="\u0424\u0443\u043d\u043a\u0446\u0438\u0438"===t.type?"FUNCTION":"OPERAND","\u0424\u0443\u043d\u043a\u0446\u0438\u0438"===t.type&&(c.setLeft(),c.setRight()))}(0,r,i)},children:[Object(Z.jsx)(k.a,{children:Object(Z.jsx)(F.a,{})}),Object(Z.jsx)(U.a,{primary:i})]},r)}))})})}var tt={MEASURES:["MEASURE_1","MEASURE_2","MEASURE_3","MEASURE_4","MEASURE_5","MEASURE_6","MEASURE_7","MEASURE_8","MEASURE_9","MEASURE_10"],FACTS:["FACT_1","FACT_2","FACT_3","FACT_4","FACT_5","FACT_6","FACT_7","FACT_8","FACT_9","FACT_10"],VARIABLES:["DISTANCE","LENGHT","HEIGHT","WEIGHT","LATITUDE","REPLICAS","CENTROID","BLOB","MAX_VAL","MIN_VAL","PI"],FUNCTIONS:["SUM","MIN","MAX","SQRT","POW","FUNC","MINMAX","ROUND"]},et=n(142),nt=["FACTS","MEASURES","VARIABLES"],it=function(t){var e=t.func,n=t.pos,i=t.left,r=t.top;return Object(Z.jsxs)(o.a,{width:"270px",position:n,left:i,top:r,children:[Object(Z.jsx)(S.a,{label:"\u041f\u043e\u0438\u0441\u043a",style:{width:"90%",margin:10}}),Object(Z.jsx)(o.a,{overflow:"auto",maxHeight:"300px",children:e?Object(Z.jsx)($,{items:tt.FUNCTIONS}):nt.map((function(t){return Object(Z.jsxs)(Z.Fragment,{children:[Object(Z.jsx)($,{items:tt[t]}),Object(Z.jsx)(et.a,{})]})}))})]})},rt=n(144),at=n(147),ct=function(){var t=D(X),e=M(),n=Object(i.useState)(!1),r=Object(s.a)(n,2),a=r[0],c=r[1],u=Object(i.useState)(!1),h=Object(s.a)(u,2),d=h[0],j=h[1],f=Object(i.useState)(""),b=Object(s.a)(f,2),v=b[0],p=b[1];return Object(i.useEffect)((function(){try{var e=new O(t);e.lexAnalisys(),console.log(e.tokenList);var n=new A(e.tokenList).parseCode();console.log(n),p("")}catch(i){console.log(i.message),p(i.message)}}),[t]),Object(Z.jsxs)(o.a,{width:"100%",display:"flex",height:"600px",flexDirection:"column",alignItems:"center",justifyContent:"center",children:[d&&Object(Z.jsx)(it,{func:!0,pos:"absolute",left:"50px",top:"50px"}),a&&Object(Z.jsx)(it,{pos:"absolute",left:"50px",top:"450px"}),Object(Z.jsxs)(o.a,{width:"60%",display:"flex",flexDirection:"column",position:"relative",children:[Object(Z.jsx)(l.a,{style:{outline:"none",width:"100%",height:"300px",fontSize:20,padding:20},value:t,onChange:function(t){e(z(t.target.value))}}),v&&Object(Z.jsx)(at.a,{style:{position:"absolute",bottom:0,width:"101%"},severity:"error",children:v})]}),Object(Z.jsxs)(o.a,{display:"flex",children:[Object(Z.jsx)(rt.a,{onClick:function(){return j(!d)},children:"Func Search"}),Object(Z.jsx)(rt.a,{onClick:function(){return c(!a)},children:"Global Search"})]})]})},st=n(52),ot=n(62),lt=n(149),ut=function(t){var e=t.items,n=t.type,r=Object(i.useState)(""),a=Object(s.a)(r,2),c=a[0],l=a[1],u=Object(i.useState)(e),h=Object(s.a)(u,2),d=h[0],j=h[1];return Object(i.useEffect)((function(){j((function(t){return e.filter((function(t){return t.includes(c)}))}))}),[c]),Object(Z.jsxs)(o.a,{width:"100%",overflow:"hidden",children:[Object(Z.jsx)(S.a,{label:n,style:{width:"90%",margin:10},value:c,onChange:function(t){return l(t.target.value)}}),Object(Z.jsx)(o.a,{maxHeight:"300px",overflow:"auto",width:"100%",children:Object(Z.jsx)($,{items:d,type:n})})]})},ht=n(79),dt=n.n(ht),jt=n(143),ft=Object(C.a)({list:{width:250},fullList:{width:"auto"},btn:{margin:10}}),Ot=function(t){var e=t.data,n=t.index,i=M(),a=(D(X),D(Q)),c=ft(),l=r.a.useState({top:!1,left:!1,bottom:!1,right:!1}),u=Object(s.a)(l,2),h=u[0],d=u[1],j=function(t,e){return function(r){("keydown"!==r.type||"Tab"!==r.key&&"Shift"!==r.key)&&(i(G(n)),d(Object(ot.a)(Object(ot.a)({},h),{},Object(st.a)({},t,e))))}};return Object(Z.jsx)("div",{children:["bottom"].map((function(t){return Object(Z.jsxs)(r.a.Fragment,{children:[Object(Z.jsx)(jt.a,{onClick:j(t,!0),children:Object(Z.jsx)(dt.a,{})}),Object(Z.jsxs)(lt.a,{anchor:t,open:h[t],onClose:j(t,!1),children:[Object(Z.jsxs)(o.a,{display:"flex",justifyContent:"center",children:[Object(Z.jsx)(rt.a,{className:c.btn,onClick:function(){i(z("+"));var t=W.find(a);t&&(t.value="+",t.type="OPERATOR",t.setLeft(),t.setRight())},variant:"outlined",children:"+"}),Object(Z.jsx)(rt.a,{className:c.btn,onClick:function(){i(z("-"));var t=W.find(a);t&&(t.value="-",t.type="OPERATOR",t.setLeft(),t.setRight())},variant:"outlined",children:"-"}),Object(Z.jsx)(rt.a,{className:c.btn,onClick:function(){i(z("*"));var t=W.find(a);t&&(t.value="*",t.type="OPERATOR",t.setLeft(),t.setRight())},variant:"outlined",children:"*"}),Object(Z.jsx)(rt.a,{className:c.btn,onClick:function(){i(z("/"));var t=W.find(a);t&&(t.value="/",t.type="OPERATOR",t.setLeft(),t.setRight())},variant:"outlined",children:"/"}),Object(Z.jsx)(rt.a,{className:c.btn,onClick:function(){i(z("OR"));var t=W.find(a);t&&(t.value="OR",t.type="OPERATOR",t.setLeft(),t.setRight())},variant:"outlined",children:"OR"}),Object(Z.jsx)(rt.a,{className:c.btn,onClick:function(){i(z("XOR"));var t=W.find(a);t&&(t.value="XOR",t.type="FUNCTION",t.setLeft())},variant:"outlined",children:"XOR"}),Object(Z.jsx)(rt.a,{className:c.btn,onClick:function(){i(z("AND"));var t=W.find(a);t&&(t.value="AND",t.type="OPERATOR",t.setLeft(),t.setRight())},variant:"outlined",children:"AND"}),Object(Z.jsx)(rt.a,{className:c.btn,onClick:function(){i(z("NOT"));var t=W.find(a);t&&(t.value="NOT",t.type="FUNCTION",t.setLeft())},variant:"outlined",children:"NOT"}),Object(Z.jsx)(rt.a,{className:c.btn,onClick:function(){i(z("ROUND"));var t=W.find(a);t&&(t.value="ROUND",t.type="FUNCTION",t.setLeft())},variant:"outlined",children:"ROUND"}),Object(Z.jsx)(rt.a,{className:c.btn,onClick:function(){i(z("SQRT"));var t=W.find(a);t&&(t.value="SQRT",t.type="FUNCTION",t.setLeft())},variant:"outlined",children:"SQRT"}),Object(Z.jsx)(rt.a,{className:c.btn,onClick:function(){i(H())},variant:"outlined",children:"()"})]}),Object(Z.jsxs)(o.a,{display:"flex",children:[Object(Z.jsx)(ut,{items:e.FUNCTIONS,type:"\u0424\u0443\u043d\u043a\u0446\u0438\u0438"}),Object(Z.jsx)(ut,{items:e.FACTS,type:"\u0424\u0430\u043a\u0442\u044b"}),Object(Z.jsx)(ut,{items:e.MEASURES,type:"\u041c\u0435\u0440\u044b"}),Object(Z.jsx)(ut,{items:e.VARIABLES,type:"\u041f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435"})]})]})]},t)}))})},bt=n(55),vt=function(t){var e=t.value,n=void 0===e?null:e,i=t.index;return n?Object(Z.jsx)(bt.a,{children:n}):Object(Z.jsx)(Ot,{data:tt,index:i||0})},pt=function t(e){var n=e.node,r=(D(Y),Object(i.useState)(!1)),a=Object(s.a)(r,2),c=a[0],l=a[1];return Object(Z.jsxs)(o.a,{display:"flex",alignItems:"center",children:[Object(Z.jsx)(bt.a,{style:{margin:5,fontSize:25},children:n.value}),!c&&Object(Z.jsx)(bt.a,{style:{margin:5,fontSize:25},children:"("}),Object(Z.jsxs)(o.a,{display:"flex",alignItems:"center",flexDirection:c?"column":"row",style:{cursor:"pointer",borderLeft:c?"2px solid black":"none",borderRight:c?"2px solid black":"none",margin:5,padding:5},children:[n.left&&"OPERAND"!==n.left.type?"FUNCTION"===n.left.type?Object(Z.jsx)(t,{node:n.left}):Object(Z.jsx)(xt,{node:n.left}):Object(Z.jsx)(vt,{value:n.left?n.left.value:null,index:n.left?n.left.index:0}),n.right&&Object(Z.jsx)(bt.a,{style:{padding:15,fontSize:25},onClick:function(){return l(!c)},children:","}),n.right&&("OPERAND"!==n.right.type?"FUNCTION"===n.right.type?Object(Z.jsx)(t,{node:n.right}):Object(Z.jsx)(xt,{node:n.right}):Object(Z.jsx)(vt,{value:n.right?n.right.value:null,index:n.right?n.right.index:0}))]}),!c&&Object(Z.jsx)(bt.a,{style:{margin:5,fontSize:25},children:")"})]})},xt=function t(e){var n=e.node,r=D(Y),a=Object(i.useState)(!1),c=Object(s.a)(a,2),l=c[0],u=c[1];return Object(Z.jsxs)(o.a,{display:"flex",alignItems:"center",flexDirection:l?"column":"row",style:{cursor:"pointer",borderLeft:r?"2px solid black":"none",borderRight:r?"2px solid black":"none",margin:5,padding:5},children:[n.left&&"OPERAND"!==n.left.type?"FUNCTION"===n.left.type?Object(Z.jsx)(pt,{node:n.left}):Object(Z.jsx)(t,{node:n.left}):Object(Z.jsx)(vt,{value:n.left?n.left.value:null,index:n.left?n.left.index:0}),Object(Z.jsx)(bt.a,{variant:"button",onClick:function(){return u(!l)},style:{margin:15,fontSize:25},children:n.value}),n.right&&"OPERAND"!==n.right.type?"FUNCTION"===n.right.type?Object(Z.jsx)(pt,{node:n.right}):Object(Z.jsx)(t,{node:n.right}):Object(Z.jsx)(vt,{value:n.right?n.right.value:null,index:n.right?n.right.index:0})]})},gt=function(){M();var t=D(X);Object(i.useEffect)((function(){e(W.root)}),[W,t]);var e=function(t){return"OPERAND"===t.type?Object(Z.jsx)(vt,{value:t.value,index:t.index}):"FUNCTION"===t.type?Object(Z.jsx)(pt,{node:t}):Object(Z.jsx)(xt,{node:t})};return Object(Z.jsx)(o.a,{width:"1000px",height:"700px",border:"1px solid black",margin:"auto",overflow:"auto",display:"flex",children:Object(Z.jsx)(o.a,{margin:"auto",children:e(W.root)})})},Nt=function(){var t=Object(i.useState)(!1),e=Object(s.a)(t,2),n=e[0];e[1];return Object(Z.jsxs)(Z.Fragment,{children:[Object(Z.jsx)(rt.a,{onClick:function(){return!1},children:n?"Text":"Visual"}),n?Object(Z.jsx)(ct,{}):Object(Z.jsx)(gt,{})]})},Rt=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,153)).then((function(e){var n=e.getCLS,i=e.getFID,r=e.getFCP,a=e.getLCP,c=e.getTTFB;n(t),i(t),r(t),a(t),c(t)}))},yt=Object(_.a)({reducer:{code:q}});c.a.render(Object(Z.jsx)(r.a.StrictMode,{children:Object(Z.jsx)(P.a,{store:yt,children:Object(Z.jsx)(Nt,{})})}),document.getElementById("root")),Rt()},96:function(t,e,n){}},[[103,1,2]]]);
//# sourceMappingURL=main.c0a48da2.chunk.js.map